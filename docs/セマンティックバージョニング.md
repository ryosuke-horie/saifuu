# セマンティックバージョニングガイド

## 概要

Saifuuプロジェクトでは、[セマンティックバージョニング 2.0.0](https://semver.org/lang/ja/)に準拠したバージョン管理を行います。

## バージョン番号の構成

バージョン番号は `MAJOR.MINOR.PATCH` の形式で表されます：

- **MAJOR**: 後方互換性のない変更を行った場合
- **MINOR**: 後方互換性を保ちつつ新機能を追加した場合
- **PATCH**: 後方互換性を保ちつつバグ修正を行った場合

### プレリリース版

開発段階では以下のプレリリース識別子を使用します：

- `alpha`: 開発初期段階（例：`0.1.0-alpha.1`）
- `beta`: 機能がほぼ完成した段階（例：`0.1.0-beta.1`）
- `rc`: リリース候補（例：`1.0.0-rc.1`）

## バージョン管理対象

### 統一バージョン管理

Saifuuプロジェクト全体で統一したバージョンを管理します：

1. **ルートpackage.json**（新規作成）
   - プロジェクト全体のバージョンを管理
   - リリース時の基準バージョン

2. **各サブプロジェクト**
   - frontend/package.json
   - api/package.json
   - e2e/package.json
   - ルートのバージョンと同期

## バージョン更新ルール

### 1. 0.x.x の開発段階

- **0.1.0**: 初期開発版
- **0.x.0**: 新機能追加（破壊的変更可能）
- **0.x.y**: バグ修正、小規模な改善

### 2. 1.0.0 以降の安定版

#### MAJOR（破壊的変更）
- APIエンドポイントの削除・変更
- データベーススキーマの非互換な変更
- 必須設定項目の追加
- 依存関係の大幅な変更

#### MINOR（機能追加）
- 新しいAPIエンドポイントの追加
- 新しいUIコンポーネントの追加
- オプション設定の追加
- パフォーマンス改善

#### PATCH（バグ修正）
- バグの修正
- セキュリティ脆弱性の修正
- ドキュメントの修正
- 依存関係の更新（破壊的変更を含まない）

## バージョン更新手順

### 1. バージョン番号の決定

```bash
# 現在のバージョンを確認
git describe --tags --abbrev=0

# コミット履歴から変更内容を確認
git log --oneline --since="last-tag"
```

### 2. package.jsonの更新

```bash
# ルートディレクトリで実行（将来的に実装）
npm version [major|minor|patch|premajor|preminor|prepatch|prerelease]

# 各サブプロジェクトのバージョンも同期更新
```

### 3. 変更履歴の記録

CHANGELOGファイルに変更内容を記録（後述の運用フロードキュメントで詳細を定義）

### 4. Gitタグの作成

```bash
# バージョンタグを作成
git tag -a v1.0.0 -m "Release version 1.0.0"

# タグをリモートにプッシュ
git push origin v1.0.0
```

## コミットメッセージとの連携

コミットメッセージのプレフィックスとバージョン更新の関係：

- `feat:` → MINOR（新機能）
- `fix:` → PATCH（バグ修正）
- `BREAKING CHANGE:` → MAJOR（破壊的変更）
- `chore:`, `docs:`, `style:`, `refactor:`, `test:` → バージョン変更なし

## 自動化の検討事項

将来的に以下の自動化を検討します：

1. **semantic-release**の導入
   - コミットメッセージから自動バージョン決定
   - CHANGELOGの自動生成
   - GitHubリリースの自動作成

2. **GitHub Actions統合**
   - PRマージ時の自動バージョン更新
   - タグプッシュ時の自動デプロイ

## 現在の状況と今後の対応

### 現在の状況
- frontend: `0.1.0`
- api: バージョンなし
- e2e: `1.0.0`（独立管理）

### 今後の対応
1. ルートpackage.jsonの作成
2. 全サブプロジェクトのバージョン統一（`0.1.0`）
3. リリースプロセスの確立
4. 自動化ツールの段階的導入

## 参考リンク

- [セマンティックバージョニング 2.0.0（日本語）](https://semver.org/lang/ja/)
- [Conventional Commits](https://www.conventionalcommits.org/ja/)
- [Keep a Changelog](https://keepachangelog.com/ja/)